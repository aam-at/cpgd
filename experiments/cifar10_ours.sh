#!/usr/bin/env bash

cd ../cifar10

# Our-li attack
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_li_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_li_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_li_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_li_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_li_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_li_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_li_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_li_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_gradient_preprocessing=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/li/our_li" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_li_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# Our-l2 attack
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l2/our_l2" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l2g_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# Our-l1 attack
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l1_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l1_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l1_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l1_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l1_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l1_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l1_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l1_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l1/our_l1" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l1_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# Our-l0 attack
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_plain_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_linf_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --attack_loss="log" --attack_iterations=500 --attack_simultaneous_updates=True --attack_primal_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_dual_lr=0.1 --attack_dual_ema=True --attack_loop_number_restarts=1 --attack_loop_finetune=True --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loop_r0_ods_init=False --attack_loop_multitargeted=False --attack_loop_c0_initial_const=0.1 --attack_save=False --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_accelerated=False --attack_momentum=0.9 --attack_adaptive_momentum=False --attack_operator="l2/3" --attack_has_ecc=False --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l0/our_l0" --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.0001, 'minimal_learning_rate': 1e-06, 'decay_steps': 500, 'name': None}}" --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --name="cifar10_l2_l0_l23_log_n500_N1_sim_adam_finetune_lr_exp_init0.01_min0.0001_flr_exp_init0.0001_min1e-06_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# best parameters for Our-li attack with 1 random restart
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_li_log_n500_N10_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_li_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_li_log_n500_N100_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_li_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_li_log_n500_N10_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_li_log_n500_N100_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_li_log_n500_N10_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_li_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="li" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/li/our_li/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_li_log_n500_N100_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# best parameters for Our-l2 attack with 1 random restart
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_l2g_log_n500_N10_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_l2g_log_n500_N100_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_l2g_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_l2g_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l2g_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.001, 'minimal_learning_rate': 1e-05, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l2g_log_n500_N10_sim_adam_finetune_lr_exp_init0.1_min0.001_flr_exp_init0.001_min1e-05_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l2g" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l2/our_l2/" --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l2g_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# best parameters for Our-l1 attack with 1 random restart
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l1/our_l1/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_l1_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l1/our_l1/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_l1_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l1/our_l1/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_l1_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l1/our_l1/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_l1_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l1/our_l1/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l1_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l1" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l1/our_l1/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l1_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"

# best parameters for Our-l0 attack with 1 random restart
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l0/our_l0/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_channel_dim=-1 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_operator="l2/3" --attack_pixel_attack=True --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_l0_l23_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --load_from="./models/cifar10_weights_plain.mat" --working_dir="../results_cifar10/test_plain/l0/our_l0/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_channel_dim=-1 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_operator="l2/3" --attack_pixel_attack=True --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_plain_l0_l23_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l0/our_l0/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_channel_dim=-1 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_operator="l2/3" --attack_pixel_attack=True --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_l0_l23_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --load_from="./models/cifar10_weights_linf.mat" --working_dir="../results_cifar10/test_linf/l0/our_l0/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_channel_dim=-1 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_operator="l2/3" --attack_pixel_attack=True --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_linf_l0_l23_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l0/our_l0/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_channel_dim=-1 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=10 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_operator="l2/3" --attack_pixel_attack=True --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l0_l23_log_n500_N10_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
python test_our_attack.py --num_batches=4 --batch_size=250 --seed=123 --attack="l0" --load_from="./models/cifar10_weights_l2.mat" --working_dir="../results_cifar10/test_l2/l0/our_l0/" --attack_accelerated=False --attack_adaptive_momentum=False --attack_boxmax=1.0 --attack_boxmin=0.0 --attack_channel_dim=-1 --attack_confidence=0.0 --attack_dual_ema=True --attack_dual_lr=0.1 --attack_dual_opt="sgd" --attack_dual_opt_kwargs="{}" --attack_gradient_preprocessing=False --attack_has_ecc=False --attack_iterations=500 --attack_loop_c0_initial_const=0.1 --attack_loop_dual_lr=0.1 --attack_loop_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.1, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune=True --attack_loop_finetune_dual_lr=0.01 --attack_loop_finetune_dual_lr_config="{'schedule': 'linear', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.001, 'decay_steps': 500, 'name': None}}" --attack_loop_finetune_lr=0.01 --attack_loop_finetune_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 0.01, 'minimal_learning_rate': 0.0001, 'decay_steps': 500, 'name': None}}" --attack_loop_lr=0.01 --attack_loop_lr_config="{'schedule': 'exp', 'config': {'initial_learning_rate': 1.0, 'minimal_learning_rate': 0.01, 'decay_steps': 500, 'name': None}}" --attack_loop_multitargeted=False --attack_loop_number_restarts=100 --attack_loop_r0_ods_init=False --attack_loop_r0_ods_steps=50 --attack_loop_r0_sampling_algorithm="uniform" --attack_loop_r0_sampling_epsilon=0.25 --attack_loss="log" --attack_min_dual_ratio=1e-06 --attack_momentum=0.9 --attack_operator="l2/3" --attack_pixel_attack=True --attack_primal_lr=0.1 --attack_primal_opt="adam" --attack_primal_opt_kwargs="{}" --attack_save=False --attack_simultaneous_updates=True --attack_targeted=False --name="cifar10_l2_l0_l23_log_n500_N100_sim_adam_finetune_lr_exp_init1.0_min0.01_flr_exp_init0.01_min0.0001_sgd_dlr_linear_init0.1_min0.01_fdlr_linear_init0.01_min0.001_uniform_R0.25_C0.1_"
